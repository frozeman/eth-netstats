template(name="index")
  div.container-fluid(ng-controller='StatsCtrl')
    div.row
      div.col-xs-2.stat-holder
        div.big-info.bestblock.text-info
          div.pull-left.icon-full-width
            i.icon-block
          div.big-details-holder
            span.small-title best block
            span.big-details {{ number Blockchain.bestBlock }}
          div.clearfix
      div.col-xs-2.stat-holder
        div.big-info.uncleCount.text-info
          div.pull-left.icon-full-width
            i.icon-uncle
          div.big-details-holder
            span.small-title uncles&nbsp;
              span.small (current / last 50)
            span.big-details {{ Blockchain.bestStats.block.uncles.length }}/{{ Blockchain.uncleCount }}
          div.clearfix
      div.col-xs-2.stat-holder
        div.big-info.blocktime(class="{{ timeClass lastBlock true }}")
          div.pull-left.icon-full-width
            i.icon-time
          div.big-details-holder
            span.small-title last block
            span.big-details {{ blockTimeFilter Blockchain.lastBlock }}
            //- span.big-details(time-ago="lastBlock")
          div.clearfix
      div.col-xs-2.stat-holder
        div.big-info.avgblocktime(class="{{ avgTimeClass avgBlockTime }}")
          div.pull-left.icon-full-width
            i.icon-gas
          div.big-details-holder
            span.small-title avg block time
            span.big-details {{ avgTimeFilter Blockchain.avgBlockTime }}
          div.clearfix
      div.col-xs-2.stat-holder
        div.big-info.difficulty.text-orange
          div.pull-left.icon-full-width
            i.icon-hashrate
          div.big-details-holder
            span.small-title avg network hashrate
            span.big-details {{networkHashrateFilter Blockchain.avgHashrate false}}
          div.clearfix
      div.col-xs-2.stat-holder
        div.big-info.difficulty.text-danger
          div.pull-left.icon-full-width
            i.icon-difficulty
          div.big-details-holder
            span.small-title difficulty
            span.big-details
              span.small-hash {{ number Blockchain.lastDifficulty }}
          div.clearfix

      div.clearfix


    div.row
      div.col-xs-8.stats-boxes(style="padding-top: 0px;")
        div.row.second-row
          div.col-xs-3.stat-holder.box
            div.active-nodes(class="{{ nodesActiveClass Blockchain.nodesActive Blockchain.nodesTotal }}")
              i.icon-node
              span.small-title active nodes
              span.small-value {{Blockchain.nodesActive}}/{{Blockchain.nodesTotal}}
          //- div.col-xs-3.stat-holder.box
          //-   div.difficulty.text-info
          //-     i.icon-difficulty
          //-     span.small-title difficulty
          //-     span.small-value {{ lastDifficulty | number }}
          div.col-xs-3.stat-holder.box
            div.gasprice.text-info
              i.icon-gasprice
              span.small-title gas price
              span.small-value {{ gasPriceFilter Blockchain.bestStats.gasPrice.toString }}
          div.col-xs-3.stat-holder.box
            div.page-latency(class="{{ latencyClass true Blockchain.latency }}")
              i.icon-clock
              span.small-title page latency
              span.small-value {{Blockchain.latency}} ms
          div.col-xs-3.stat-holder.box
            div.uptime(class="{{ upTimeClass upTimeTotal true }}")
              i.icon-bulb
              span.small-title uptime
              span.small-value {{ upTimeFilter Blockchain.upTimeTotal }}

        div.row
          div.col-xs-3.stat-holder
            div.big-info.chart(class="{{ avgTimeClass Blockchain.avgBlockTime }}")
              //- i.icon-time
              span.small-title block time
              //- span.small-value {{ avgBlockTime | avgTimeFilter }}
              sparkchart.big-details.spark-blocktimes(data="{{Blockchain.lastBlocksTime.join}}", tooltipsuffix="s")

          div.col-xs-3.stat-holder
            div.big-info.chart.text-info
              //- i.icon-difficulty
              span.small-title difficulty
              //- span.small-value {{ lastDifficulty | number }}
              sparkchart.big-details.spark-difficulty(data="{{Blockchain.difficultyChart.join}}")

          div.col-xs-3.stat-holder.xpull-right
            div.big-info.chart.xdouble-chart(class="{{ propagationAvgTimeClass Blockchain.blockPropagationAvg true }}")
              //- i.icon-gas
              span.small-title block propagation
              //- span.small-value {{ blockPropagationAvg | blockPropagationFilter : '' }}
              histogram.big-details.d3-blockpropagation(data="blockPropagationChart")

          div.col-xs-3.stat-holder.pull-right
            div.big-info.chart.double-chart
              span.small-title last blocks miners
              div.blocks-holder(ng-repeat='miner in miners track by miner.miner', data-toggle="tooltip", data-placement="right", data-original-title="{{Blockchain.miner.blocks}}")
                div.block-count(class="{{minerBlocksClass Blockchain.miner.blocks 'text-'}}") {{miner.blocks}}
                //- div.small-title-miner {{miner.miner | minerNameFilter : miner.name}}
                div.small-title-miner {{miner.miner}}
                minerblock(blocks="{{Blockchain.miner.blocks}}")
                div.clearfix

          div.col-xs-3.stat-holder
            div.big-info.chart.text-info
              //- i.icon-uncle
              span.small-title uncle count&nbsp;
                span.small (25 blocks per bar)
              //- span.small-value {{ bestStats.block.uncles.length }}/{{ uncleCount }}
              sparkchart.big-details.spark-uncles(data="{{Blockchain.uncleCountChart.join}}")

          div.col-xs-3.stat-holder
            div.big-info.chart.text-info
              //- i.icon-uncle
              span.small-title transactions
              sparkchart.big-details.spark-transactions(data="{{Blockchain.transactionDensity}}")

          div.col-xs-3.stat-holder
            div.big-info.chart.text-info
              //- i.icon-gasprice
              span.small-title gas spending
              sparkchart.big-details.spark-gasspending(data="{{Blockchain.gasSpending.join}}")



      div.col-xs-4.stat-holder.map-holder
        //- div.col-xs-12
        nodemap#mapHolder(data="map")

      div.col-xs-12.stats-boxes
        div.row.second-row
          div.col-xs-12.stat-holder.box
            div.active-nodes.text-orange
              i.icon-hashrate
              span.small-title Block #1028201 hash
              span.small-value {{Blockchain.frontierHash}}

      div.clearfix

    
    div.row(style="padding-top: 10px")
      table.table.table-striped
        thead
          tr.text-info
            th.th-nodecheck
              i.icon-check-o(data-toggle="tooltip", data-placement="top", title="Pin nodes to display first", ng-click="orderTable(['-stats.block.number', 'stats.block.propagation'], false)")
            th.th-nodename
              i.icon-node(data-toggle="tooltip", data-placement="top", title="Node name", ng-click="orderTable(['info.name'], false)")
            th.th-nodetype
              i.icon-laptop(data-toggle="tooltip", data-placement="top", title="Node type", ng-click="orderTable(['info.node'], false)")
            th.th-latency
              i.icon-clock(data-toggle="tooltip", data-placement="top", title="Node latency", ng-click="orderTable(['stats.latency'], false)")
            th
              i.icon-mining(data-toggle="tooltip", data-placement="top", title="Is mining", ng-click="orderTable(['-stats.hashrate'], false)")
            th
              i.icon-group(data-toggle="tooltip", data-placement="top", title="Peers", ng-click="orderTable(['-stats.peers'], false)")
            th
              i.icon-network(data-toggle="tooltip", data-placement="top", title="Pending transactions", ng-click="orderTable(['-stats.pending'], false)")
            th
              i.icon-block(data-toggle="tooltip", data-placement="top", title="Last block", ng-click="orderTable(['-stats.block.number', 'stats.block.propagation'], false)")
            th.th-blockhash &nbsp;
            th.th-blockhash
              i.icon-difficulty(data-toggle="tooltip", data-placement="top", title="Total difficulty", ng-click="orderTable(['-stats.block.totalDifficulty'], false)")
            th
              i.icon-check-o(data-toggle="tooltip", data-placement="top", title="Block transactions", ng-click="orderTable(['-stats.block.transactions.length'], false)")
            th
              i.icon-uncle(data-toggle="tooltip", data-placement="top", title="Uncles", ng-click="orderTable(['-stats.block.uncles.length'], false)")
            th.th-blocktime
              i.icon-time(data-toggle="tooltip", data-placement="top", title="Last block time", ng-click="orderTable(['-stats.block.received'], false)")
            th.th-peerPropagationTime
              i.icon-gas(data-toggle="tooltip", data-placement="top", title="Propagation time", ng-click="orderTable(['-stats.block.number', 'stats.block.propagation'], false)")
            th.th-peerPropagationChart
            th.th-peerPropagationAvg
              i.icon-gas(data-toggle="tooltip", data-placement="top", title="Average propagation time", ng-click="orderTable(['stats.propagationAvg'], false)")
            th
              i.icon-bulb(data-toggle="tooltip", data-placement="top", title="Up-time", ng-click="orderTable(['-stats.uptime'], false)")
        tbody
          +each(nodes)
            tr(ng-repeat='node in nodes | orderBy:predicate track by node.id', class="{{ mainClass stats Blockchain.bestBlock }}", id="node_{{id}}")
              td.td-nodecheck
                i(ng-click="pinNode(id)", class="{{ nodePinClass pinned }}", data-toggle="tooltip", data-placement="right", data-original-title="Click to {{#if pinned}}'un'{{else}}''{{/if}}pin")
              td.nodeInfo(rel="{{id}}")
                span.small(data-toggle="tooltip", data-placement="top", data-html="true", data-original-title="{{geoTooltip this}}") {{info.name}}
                span.small &nbsp;({{info.ip}})
                a.small(href="https://github.com/ethereum/wiki/wiki/Network-Status#updating", target="_blank", data-toggle="tooltip", data-placement="top", data-html="true", data-original-title="Netstats client needs update.<br>Click this icon for instructions.", class="{{ nodeClientClass info Blockchain.currentApiVersion }}")
                  i.icon-warning-o
              td
                div.small {{nodeVersion info.node}}
              td(class="{{ readable.latencyClass }}")
                span.small {{ readable.latency }}
              td(class="{{ hashrateClass stats.mining stats.active }}") {{hashrateFilter stats.hashrate stats.mining}}
              td(class="{{ peerClass stats.peers stats.active }}", style="padding-left: 11px;") {{stats.peers}}
              td(style="padding-left: 15px;") {{stats.pending}}
              td(class="{{ blockClass stats Blockchain.bestBlock }}")
                span(class="{{#if readable.forkMessage}} {{readable.forkClass}} {{else}} '' {{/if}}") {{ number stats.block.number }}
                //- a.small(data-toggle="tooltip", data-placement="top", data-html="true", data-original-title="{{ readable.forkMessage }}", class="{{ readable.forkClass }}")
                  i.icon-warning-o
              td(class="{{ blockClass stats Blockchain.bestBlock }}")
                span.small {{hashFilter stats.block.hash}}
              td(class="{{ blockClass stats Blockchain.bestBlock }}")
                span.small {{number stats.block.totalDifficulty}}
              td(style="padding-left: 14px;") {{stats.block.transactions.length}}
              td(style="padding-left: 14px;") {{stats.block.uncles.length}}
              td(class="{{ timeClass stats.block.received stats.active }}") {{blockTimeFilter stats.block.received }}
              td(class="{{ propagationTimeClass stats Blockchain.bestBlock }}")
                div.propagationBox
                span {{blockPropagationFilter stats.block.propagation false}}
              td.peerPropagationChart(class="{{id}}")
                //- nodepropagchart(data="{{history.join}}")
              td(class="{{ propagationNodeAvgTimeClass stats Blockchain.bestBlock }}") {{ blockPropagationAvgFilter stats Blockchain.bestBlock }}
              td(class="{{ upTimeClass stats.uptime stats.active }}") {{ upTimeFilter stats.uptime }}
